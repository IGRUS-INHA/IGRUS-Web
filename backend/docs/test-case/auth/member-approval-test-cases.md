# 준회원 승인 테스트 케이스

**작성일**: 2026-01-23
**버전**: 1.0
**관련 스펙**: [auth-spec.md](../../../../docs/feature/auth/auth-spec.md)
**우선순위**: P2

---

## 1. 개요

준회원 승인 기능에 대한 테스트 케이스입니다. 관리자(ADMIN)가 준회원을 정회원으로 승인하여 전체 기능 접근 권한을 부여하는 과정을 검증합니다.

---

## 2. 테스트 케이스

### 2.1 준회원 목록 조회

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 예상 결과 | 상태 |
|----|-------------|----------|-----------|----------|------|
| APR-001 | 관리자 준회원 목록 조회 성공 | ADMIN 역할로 로그인 | 승인 대기 준회원 목록 조회 요청 | 준회원 목록 반환 (학번, 본명, 학과, 가입 동기 등 상세 정보 포함) | ✅ |
| APR-002 | 준회원 상세 정보 표시 | 준회원 목록 조회 성공 | 각 준회원 정보 확인 | 학번, 본명, 학과, 가입 동기, 가입일 등 표시 | ✅ |
| APR-003 | 준회원이 없는 경우 빈 목록 | 승인 대기 준회원 없음 | 준회원 목록 조회 요청 | 빈 목록 반환 (적절한 메시지 표시) | ✅ |
| APR-004 | 목록 페이지네이션 | 다수의 준회원 존재 | 페이지별 목록 조회 | 페이지네이션 적용된 목록 반환 | ✅ |

### 2.2 개별 승인

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 예상 결과 | 상태 |
|----|-------------|----------|-----------|----------|------|
| APR-010 | 관리자 개별 승인 성공 | ADMIN 역할로 로그인, 준회원 존재 | 특정 준회원 선택 후 승인 버튼 클릭 | 해당 사용자 역할이 MEMBER로 변경, 승인일 기록 | ✅ |
| APR-011 | 승인 후 역할 변경 확인 | 개별 승인 완료 | 승인된 사용자로 로그인 | 역할이 MEMBER로 표시 | ✅ |
| APR-012 | 승인일 정확히 기록 | 개별 승인 완료 | 승인 이력 확인 | 승인 시점의 날짜/시간 정확히 기록 | ✅ |
| APR-013 | 역할 변경 감사 이력 기록 | 개별 승인 완료 | UserRoleHistory 확인 | ASSOCIATE → MEMBER 변경 이력 기록 | ✅ |

### 2.3 일괄 승인

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 예상 결과 | 상태 |
|----|-------------|----------|-----------|----------|------|
| APR-020 | 다수 준회원 일괄 승인 성공 | ADMIN 역할로 로그인, 5명의 준회원 존재 | 5명 모두 선택 후 일괄 승인 실행 | 5명 모두 MEMBER로 변경 | ✅ |
| APR-021 | 일부 준회원 선택 후 일괄 승인 | 10명의 준회원 존재 | 3명 선택 후 일괄 승인 | 선택된 3명만 MEMBER로 변경, 나머지 7명은 ASSOCIATE 유지 | ✅ |
| APR-022 | 일괄 승인 시 각각 승인일 기록 | 일괄 승인 완료 | 각 사용자 승인 이력 확인 | 각 사용자별 승인일 개별 기록 | ✅ |
| APR-023 | 일괄 승인 시 역할 변경 이력 개별 기록 | 일괄 승인 완료 | UserRoleHistory 확인 | 각 사용자별 역할 변경 이력 개별 기록 | ✅ |
| APR-024 | 선택 없이 일괄 승인 시도 | 아무도 선택하지 않음 | 일괄 승인 버튼 클릭 | 일괄 승인 버튼 비활성화 또는 경고 메시지 | ✅ |

### 2.4 권한 검증

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 예상 결과 | 상태 |
|----|-------------|----------|-----------|----------|------|
| APR-030 | 운영진 승인 시도 시 거부 | OPERATOR 역할로 로그인 | 준회원 승인 시도 | "관리자 권한이 필요합니다" 메시지 표시, 403 Forbidden | ✅ |
| APR-031 | 정회원 승인 시도 시 거부 | MEMBER 역할로 로그인 | 준회원 승인 API 호출 시도 | 403 Forbidden | ✅ |
| APR-032 | 준회원 승인 시도 시 거부 | ASSOCIATE 역할로 로그인 | 준회원 승인 API 호출 시도 | 403 Forbidden | ✅ |
| APR-033 | 비로그인 상태 승인 시도 시 거부 | 비로그인 상태 | 준회원 승인 API 호출 시도 | 401 Unauthorized | ✅ |
| APR-034 | 운영진 목록 조회 시도 시 거부 | OPERATOR 역할로 로그인 | 준회원 목록 조회 시도 | 403 Forbidden | ✅ |

### 2.5 ADMIN 권한 보호

| ID | 테스트 케이스 | 사전 조건 | 테스트 단계 | 예상 결과 | 상태 |
|----|-------------|----------|-----------|----------|------|
| APR-040 | 마지막 ADMIN 권한 변경 시도 | 시스템에 ADMIN이 1명만 존재 | 해당 ADMIN 역할 변경 시도 | "마지막 관리자는 권한을 변경할 수 없습니다" 메시지 표시, 변경 거부 | ✅ |
| APR-041 | 여러 ADMIN 존재 시 권한 변경 가능 | 시스템에 ADMIN이 2명 이상 존재 | 한 명의 ADMIN 역할 변경 | 정상적으로 역할 변경됨 | ✅ |

---

## 3. 관련 Functional Requirements

| ID | 요구사항 | 관련 테스트 케이스 |
|----|---------|------------------|
| FR-026 | 관리자(ADMIN) 준회원 목록 조회 | APR-001 ~ APR-004 |
| FR-027 | 관리자(ADMIN)만 준회원 승인 가능 | APR-010 ~ APR-013, APR-030 ~ APR-034 |
| FR-028 | 개별 승인 및 일괄 승인 제공 | APR-010 ~ APR-024 |
| Edge Case | 마지막 ADMIN 권한 변경 불가 | APR-040, APR-041 |

---

## 4. 예상 테스트 클래스 구조

```java
@Nested
@DisplayName("준회원 승인 테스트")
class MemberApprovalTest {

    @Nested
    @DisplayName("준회원 목록 조회")
    class AssociateListTest {
        // APR-001 ~ APR-004
    }

    @Nested
    @DisplayName("개별 승인")
    class IndividualApprovalTest {
        // APR-010 ~ APR-013
    }

    @Nested
    @DisplayName("일괄 승인")
    class BulkApprovalTest {
        // APR-020 ~ APR-024
    }

    @Nested
    @DisplayName("권한 검증")
    class AuthorizationTest {
        // APR-030 ~ APR-034
    }

    @Nested
    @DisplayName("ADMIN 권한 보호")
    class AdminProtectionTest {
        // APR-040 ~ APR-041
    }
}
```

---

## 5. 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-23 | - | 최초 작성 |
