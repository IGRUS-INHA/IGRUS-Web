# Feature Specification: 학기별 회원 명단 조회

**Created**: 2026-01-25
**Updated**: 2026-01-31
**Status**: Draft
**Input**: 익명화를 제거하고 학기별 멤버십 기록을 추가하여 과거 회원 명단 조회 지원

---

## 개요

동아리 운영의 연속성과 이력 관리를 위해 학기별 회원 명단을 조회할 수 있는 기능이다. 기존 익명화 로직을 제거하여 탈퇴 회원의 개인정보를 보존하고, 학기별 멤버십 기록 테이블을 추가하여 특정 학기에 누가 활동했는지 추적한다.

회원 정보는 User 테이블에 원본 그대로 유지되며, 별도로 복제하지 않는다. 학기별 멤버십 기록은 User 테이블과 JOIN하여 명단을 조회한다.

### 기존 대비 변경점

- **제거**: 탈퇴 회원 개인정보 익명화 (anonymize 메서드, 스케줄러, anonymized 필드)
- **유지**: 탈퇴 시 인증 데이터(비밀번호, 리프레시 토큰, 이메일 인증, 개인정보 동의) hard delete
- **추가**: 학기별 멤버십 기록 테이블 (SemesterMember)

---

## User Scenarios & Testing

### User Story 1 - 학기별 회원 등록 (Priority: P1)

관리자가 특정 학기에 회원을 등록한다.

**Why this priority**: 학기별 명단 관리의 시작점이다.

**Independent Test**: 관리자가 현재 회원을 선택하여 특정 학기에 등록하고, 정상적으로 기록되는지 확인한다.

**Acceptance Scenarios**:

1. **Given** 관리자(ADMIN)가 학기별 회원 관리 메뉴에 접속한 상태에서, **When** 학기를 선택하고 회원 등록을 선택하면, **Then** 현재 준회원(ASSOCIATE) 이상의 회원 목록이 체크박스와 함께 표시된다
2. **Given** 관리자가 회원을 선택한 상태에서, **When** 등록을 실행하면, **Then** 선택된 회원의 당시 역할과 함께 해당 학기 멤버십이 기록된다
3. **Given** 이미 해당 학기에 등록된 회원이 목록에 표시될 때, **Then** "이미 등록됨" 표시와 함께 체크박스가 비활성화된다
4. **Given** 관리자가 전체 선택을 클릭한 상태에서, **When** 등록을 실행하면, **Then** 아직 등록되지 않은 모든 회원이 해당 학기에 기록된다

---

### User Story 2 - 학기별 회원 제외 (Priority: P1)

관리자가 특정 학기에서 회원을 제외한다.

**Why this priority**: 잘못 등록된 회원을 정리하는 필수 기능이다.

**Independent Test**: 관리자가 특정 학기에서 회원을 제외하고, 해당 회원이 목록에서 제거되는지 확인한다.

**Acceptance Scenarios**:

1. **Given** 관리자가 특정 학기의 회원 목록을 조회한 상태에서, **When** 특정 회원들을 선택하고 제외를 실행하면, **Then** 선택된 회원의 멤버십 기록이 삭제된다
2. **Given** 제외가 완료된 상태에서, **When** 해당 학기 명단을 다시 조회하면, **Then** 제외된 회원이 목록에 표시되지 않는다

---

### User Story 3 - 학기별 명단 조회 (Priority: P1)

관리자 또는 운영진이 특정 학기의 회원 명단을 조회한다.

**Why this priority**: 과거 명단 조회가 이 기능의 핵심 목적이다.

**Independent Test**: 운영진이 과거 학기를 선택하여 해당 학기 회원 목록을 조회할 수 있는지 확인한다.

**Acceptance Scenarios**:

1. **Given** 운영진(OPERATOR) 이상 권한의 사용자가 학기별 명단 조회 메뉴에 접속한 상태에서, **When** 학기 목록을 요청하면, **Then** 멤버십 기록이 존재하는 학기 목록이 회원 수와 함께 최신순으로 표시된다
2. **Given** 사용자가 특정 학기를 선택한 상태에서, **When** 명단 조회를 요청하면, **Then** 해당 학기의 회원 목록(학번, 본명, 학과, 역할, 이메일, 전화번호)이 표시된다
3. **Given** 해당 학기에 등록된 회원 중 탈퇴한 회원이 있을 때, **When** 명단을 조회하면, **Then** 탈퇴 회원의 정보도 정상적으로 표시된다 (탈퇴 여부 표시 포함)
4. **Given** 일반 회원(MEMBER)이, **When** 학기별 명단 조회를 시도하면, **Then** "권한이 없습니다" 메시지가 표시된다

---

### Edge Cases

- 회원이 등록 후 탈퇴하더라도 User 테이블의 개인정보가 보존되므로 명단 조회에 영향 없다
- 멤버십 등록 시점의 역할이 기록된다 (예: ASSOCIATE로 등록 후 MEMBER로 승격되어도 멤버십 기록에는 ASSOCIATE로 남는다)
- 학기 형식은 "YYYY년 N학기" (예: 2026년 1학기)로 통일한다
- 동일 회원을 같은 학기에 중복 등록할 수 없다
- 명단 조회 시 탈퇴 회원은 User 테이블의 soft delete 필터(`@SQLRestriction`)를 우회하여 조회해야 한다

---

## Requirements

### Functional Requirements

**익명화 제거**
- **FR-001**: 시스템은 탈퇴 회원의 개인정보(학번, 본명, 학과, 이메일, 전화번호, 가입동기)를 익명화하지 않고 보존해야 한다
- **FR-002**: 시스템은 탈퇴 시 인증 관련 데이터(비밀번호, 리프레시 토큰, 이메일 인증, 개인정보 동의)는 기존과 동일하게 hard delete 해야 한다

**학기별 회원 등록/제외**
- **FR-003**: 시스템은 관리자(ADMIN)에게 학기별 회원 등록 기능을 제공해야 한다
- **FR-004**: 시스템은 회원 등록 시 준회원(ASSOCIATE) 이상 역할의 회원을 선택 가능하도록 해야 한다
- **FR-005**: 시스템은 멤버십 등록 시 해당 시점의 역할을 기록해야 한다
- **FR-006**: 시스템은 이미 등록된 회원의 동일 학기 중복 등록을 방지해야 한다
- **FR-007**: 시스템은 관리자(ADMIN)에게 학기별 회원 제외 기능을 제공해야 한다

**학기별 명단 조회**
- **FR-008**: 시스템은 운영진(OPERATOR) 이상 권한에게 학기별 명단 조회 기능을 제공해야 한다
- **FR-009**: 시스템은 학기 목록을 최신순으로 정렬하고 학기별 회원 수를 함께 표시해야 한다
- **FR-010**: 시스템은 명단 조회 시 탈퇴 회원을 포함하여 조회해야 한다 (soft delete 필터 우회)
- **FR-011**: 시스템은 명단 조회 시 검색 및 필터링 기능을 제공해야 한다

---

### Key Entities

- **SemesterMember**: 학기별 멤버십 기록 (user_id FK → User, semester, role, created_at)
- **User** (기존 엔티티 수정): anonymize() 메서드 및 anonymized 필드 제거

---

## Success Criteria

### Measurable Outcomes

- **SC-001**: 운영진은 학기별 명단을 3초 이내에 조회할 수 있다
- **SC-003**: 탈퇴 회원의 개인정보가 User 테이블에 100% 보존된다
- **SC-004**: 과거 학기의 멤버십 기록이 정확하게 조회된다

---

## Assumptions

- 학기는 1학기(3월~8월)와 2학기(9월~2월)로 구분한다
- 멤버십 등록 대상은 준회원(ASSOCIATE) 이상 해당된다
- 인하대학교 학사일정을 기준으로 학기를 구분한다
- 탈퇴 회원의 개인정보는 익명화 없이 영구 보존한다

---

## Out of Scope

- 회원의 활동 이력(게시글, 출석 등) 기록
- 자동 학기 등록 스케줄링 (수동 등록만 지원)
- 회원 정보를 별도 테이블에 복제/스냅샷하는 방식의 아카이빙
- 개인정보 익명화 및 영구 삭제 기능
